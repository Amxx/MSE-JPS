{##############################################################################
 #                                  MSE-JPS                                   #
 #                 Mini Site Engine - Javascript / PHP / SQL                  #
 #                                                                            #
 #                        Version 2.3.0-1 : 10/02/2016                        #
 #                                                                            #
 #                      Developped by Hadrien Croubois :                      #
 #                         hadrien.croubois@gmail.com                         #
 #                                                                            #
 ##############################################################################}

{# Main javascript #}
<script type="text/javascript">

	$.mobile.loading().hide();

	$(function(){
		// Record visibility
		var id = $('section').filter(function(){ return $(this).css('display') != 'none'; }).attr('id');
		// Set visibility for javascript
		$('section').show();

		// make tiles
		$('section').packery({ 'itemSelector': '.block' });

		// Run javascript
		{% for page in website.pages.list %}
		{% for article in page.articles.list %}
		{% if article.javascript %}
			{{ article.javascript | raw }}
		{% endif %}
		{% endfor %}
		{% endfor %}

		// Reset visibility
		$('section').filter(function(){ return $(this).attr('id') != id; }).hide()
	});
</script>